<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Canvas Demo</title>
  <script>
    window.onload = function(){
      var canvas = document.getElementById("paper"),
          ctx = canvas.getContext("2d");
      var flag = 0;
      var start = 0;
      
      
      var makeImage = function(url, x, y) {
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, canvas.width, canvas.height - 70);
        
        ctx.fillStyle = "#333";
        ctx.fillRect(0, 220, canvas.width, 80);
        
        var imageObj = new Image();
        
        imageObj.onload = function() {
          ctx.drawImage(imageObj, x, y);
        };
        imageObj.src = url;
      };
      
      
      function Player(){
        var player = this;
        this.isjumping = "no";
        
        this.stand = function(){
          console.log(start);
          makeImage("images/stand.png", 50, 120);
          flag = 0;
          
          document.onkeypress = checkKey;
          function checkKey(key) {
            if(key.keyCode === 32){
              player.walk();
            }
          }
        };
        
        this.jump = function() {
          var posY = 120;
          var state = "up";
          
          var jumpAnimation = setInterval(function () {
            if (state === "up") {
              makeImage("images/stand.png", 50, posY);
              posY -= 5;
              console.log(state);
              
              if (posY === 40) {
                makeImage("images/stand.png", 50, posY);
                state = "down";
              }
            }
            if (state === "down") {
              console.log(state);
              makeImage("images/stand.png", 50, posY);
              posY += 5;
              
              if (posY === 120) {
                console.log(state);
                clearInterval(jumpAnimation);
                player.isjumping = "no";
                player.walk();
                flag = 3;
              }
            }
          }, 16);
          
          
        };
        
        this.walk = function() {
          console.log("walk");
          var walkInterval = setInterval(function () {
            if (flag === 0 || flag === 2 || flag === 3) {
              makeImage("images/walk1.png", 50, 120);
              flag = 1;
            } else if (flag === 1) {
              makeImage("images/walk2.png", 50, 120);
              flag = 2;
            }
          }, 100);
          
          document.onkeypress = checkKey;
          function checkKey(key) {
            if(key.keyCode === 32 && player.isjumping === "no"){
              player.isjumping = "yes";
              clearInterval(walkInterval);
              player.jump();
            }
          }
        };
        
      } // Player end
      
      
      var field = function(){
        ctx.fillstyle = "black";
        ctx.fillRect(0, 230, canvas.width, 70);
      };
      
      
      var player = new Player();
      
      player.stand();
      
      
      
    }; // window.onload ended
  </script>
</head>
<body>
<canvas id="paper" width="1300" height="300">

</canvas>
</body>
</html>