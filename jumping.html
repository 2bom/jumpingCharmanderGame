<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Canvas Demo</title>
  <script>
    window.onload = function(){
      var canvas = document.getElementById("paper"),
          ctx = canvas.getContext("2d");
      var flag = 0;
      var start = 0;
    
      var makeImage = function(url, x, y) {
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        var imageObj = new Image();
        
        imageObj.onload = function() {
          ctx.drawImage(imageObj, x, y);
        };
        imageObj.src = url;
      };
       
      function Player(){
        var player = this;
        
        this.stand = function(){
          console.log(start);
          makeImage("images/stand.png", 50, 120);
          flag = 0;
  
          document.onkeypress = checkKey;
          function checkKey(key) {
            if(key.keyCode === 32){
              player.walk();
            }
          }
        };
        
        this.jump = function() {
          var posY = 120;
          var state = "up";
          
          var jumpAnimation = setInterval(function(){
            if (state === "up"){
              makeImage("images/stand.png", 50, posY);
              posY -= 3;
              
              if (posY < 40){
              console.log(state);
                state = "down";
              }
            }
            if (state === "down") {
              console.log(state);
                makeImage("images/stand.png", 50, posY);
                posY += 3;
  
              if (posY > 120){
              console.log(state);
                clearInterval(jumpAnimation);
                flag = 3;
                player.walk();
              }
            }
          }, 10);
          
        };
        
        this.walk = function() {
          var walkInterval = setInterval(function () {
            if (flag === 0 || flag === 2 || flag === 3) {
              makeImage("images/walking01.png", 50, 120);
              flag = 1;
            } else if (flag === 1) {
              makeImage("images/walking02.png", 50, 120);
              flag = 2;
            }
          }, 100);
  
//          console.log(this);
  
          document.onkeypress = checkKey;
          function checkKey(key) {
            if(key.keyCode === 32){
              window.clearInterval(walkInterval);
//              console.log(player);
              player.jump();
            }
          }
          
        };
  
//        function checkKey(key) {
//          if(key.keyCode = 32 || window.event){
//            console.log(player);
//            if (flag === 0){
//              player.walk();
//            } else if (flag === 1 || flag === 2){
//              player.stand();
//            }
//          }
//        }
        
      }
        
      var player = new Player();
      
      player.walk();
//
//      var keyPressing = function() {
//        document.onkeypress = checkKey;
//
//        function checkKey(e) {
//          if(e.keyCode = 32 || window.event){
//            window.clearInterval(walkInterval);
//            stand();
//          }
//        }
//      };
  
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "white";
      

    }; // window.onload ended
      
//      var rocket = new Object;
//      var rocketX = 100;
//      function drawRocket(x) {
//        ctx.fillStyle = "white";
//        ctx.fillRect(0, 0, canvas.width, canvas.height);
//
//        ctx.beginPath();
//        ctx.moveTo(x, 10);
//        ctx.lineTo(x+60, 10);
//        ctx.quadraticCurveTo(x + 70, 10, x + 70, 20);
//        ctx.lineTo(x + 70, 80);
//        ctx.quadraticCurveTo(x + 70, 90, x + 60, 90);
//        ctx.lineTo(x, 90);
//        ctx.quadraticCurveTo(x - 10, 90, x - 10, 80);
//        ctx.lineTo(x - 10, 20);
//        ctx.quadraticCurveTo(x - 10, 10, x, 10);
//        ctx.stroke();
//        ctx.fill();
//      }
//
//      setInterval(function(){
//        if (rocketX + 70 < canvas.height){
//          rocketX += 2;
//          drawRocket(rocketX);
//        }
//      },30);
      
  </script>
</head>
<body>
    <canvas id="paper" width="1300" height="250">
      
    </canvas>
</body>
</html>